<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ミーティング予約枠作成ツール</title>
    <link rel="stylesheet" href="/src/styles/main.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ミーティング予約枠作成ツール</h1>
            <p>Google Calendar にミーティングの予約枠を簡単に作成できます</p>
            <div id="userInfo" class="user-info"></div>
        </div>

        <!-- ログイン画面 -->
        <div id="loginSection" class="section" style="display: none;">
            <div style="text-align: center; padding: 60px 20px;">
                <h2>ログインが必要です</h2>
                <p style="margin: 20px 0;">このツールを使用するには、Googleアカウントでログインしてください。</p>
                <button class="btn-primary" onclick="login()">
                    Googleでログイン
                </button>
            </div>
        </div>


        <!-- メインセクション -->
        <div id="mainSection" class="section" style="display: none;">
            <h2>ミーティング予約枠設定</h2>
            <form id="scheduleForm">
                <div class="form-group">
                    <label for="title">ミーティングのタイトル *</label>
                    <input type="text" id="title" name="title" required placeholder="例: 1on1ミーティング">
                </div>

                <div class="form-group">
                    <label for="description">説明</label>
                    <textarea id="description" name="description" placeholder="ミーティングの説明を入力してください"></textarea>
                </div>

                <div class="form-group">
                    <label>予約時間 *</label>
                    <div class="duration-buttons">
                        <button type="button" class="duration-btn" data-duration="30">30分</button>
                        <button type="button" class="duration-btn active" data-duration="60">1時間</button>
                        <button type="button" class="duration-btn" data-duration="120">2時間</button>
                    </div>
                    <input type="hidden" id="duration" name="duration" value="60" required>
                </div>

                <div class="form-group">
                    <label for="location">場所</label>
                    <select id="location" name="location">
                        <option value="meet">Google Meet（自動生成）</option>
                        <option value="phone">電話</option>
                        <option value="physical">対面</option>
                        <option value="custom">カスタム</option>
                    </select>
                </div>

                <div class="form-group" id="customLocationGroup" style="display: none;">
                    <label for="customLocation">カスタム場所</label>
                    <input type="text" id="customLocation" name="customLocation" placeholder="場所の詳細を入力">
                </div>

                <div class="form-group">
                    <label>参加者 *</label>
                    <div class="participants-container">
                        <div class="participants-search">
                            <input type="text" id="participantSearch" placeholder="名前またはメールアドレスで検索" autocomplete="off">
                            <div id="searchResults" class="search-results" style="display: none;"></div>
                        </div>
                        <div class="selected-participants" id="selectedParticipants">
                            <p class="no-participants">参加者が選択されていません</p>
                        </div>
                        <input type="hidden" id="participants" name="participants" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>利用可能な日付と時間帯 *</label>
                    <div class="date-time-selector">
                        <div class="date-input-container">
                            <input type="date" id="dateInput" class="date-input">
                            <input type="time" id="startTimeInput" value="09:00">
                            <span>〜</span>
                            <input type="time" id="endTimeInput" value="17:00">
                            <button type="button" class="btn-add-date" onclick="addDateTime()">
                                日程を追加
                            </button>
                        </div>
                        <div class="selected-dates" id="selectedDates">
                            <!-- 選択された日付がここに表示される -->
                        </div>
                    </div>
                </div>


                <button type="button" class="btn-primary" onclick="showConfirmation()">
                    確認画面へ
                </button>
            </form>

        </div>

        <!-- 確認画面 -->
        <div id="confirmSection" class="section" style="display: none;">
            <h2>予約内容の確認</h2>
            <div class="preview-section">
                <div id="confirmContent"></div>
            </div>
            <div style="margin-top: 30px; text-align: center;">
                <button type="button" class="btn-secondary" onclick="backToEdit()">
                    戻る
                </button>
                <button type="button" class="btn-primary" onclick="createMeetings()">
                    予約枠を作成
                </button>
            </div>
        </div>

        <!-- 作成済み予定一覧 -->
        <div id="createdSection" class="section" style="display: none;">
            <h2>作成された予約枠</h2>
            <div class="created-meetings-list" id="createdMeetingsList">
                <!-- 作成された予定がここに表示される -->
            </div>
            <div style="margin-top: 30px; text-align: center;">
                <button type="button" class="btn-secondary" onclick="copyMeetingsList()">
                    一覧をコピー
                </button>
                <button type="button" class="btn-primary" onclick="createNew()">
                    新規作成
                </button>
                <button type="button" class="btn-danger" onclick="deleteAllMeetings()">
                    すべて削除
                </button>
            </div>
        </div>

        <div class="error-message" id="errorMessage"></div>
        <div class="success-message" id="successMessage"></div>
        
        <!-- デバッグ用 -->
        <div style="margin-top: 50px; padding: 20px; background: #f0f0f0; border-radius: 5px;">
            <h4>デバッグ情報</h4>
            <p>このセクションは開発中のみ表示されます。</p>
            <button onclick="document.getElementById('loginSection').style.display='block'">ログイン画面を強制表示</button>
            <button onclick="document.getElementById('mainSection').style.display='block'">メイン画面を強制表示</button>
        </div>
    </div>

    <!-- Google API Client Library -->
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client" onload="console.log('GIS loaded')"></script>
    
    <script type="module" src="/src/js/main.js"></script>
</body>
</html>